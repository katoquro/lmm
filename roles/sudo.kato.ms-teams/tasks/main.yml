---
- name: Get DEB architecture
  ansible.builtin.command: dpkg --print-architecture
  register: deb_architecture
  changed_when: deb_architecture.rc != 0

- name: Add repo
  become: true
  ansible.builtin.deb822_repository:
    name: teams
    uris: https://packages.microsoft.com/repos/ms-teams
    architectures: '{{ deb_architecture.stdout }}'
    suites: stable
    components:
      - main
    signed_by: https://packages.microsoft.com/keys/microsoft.asc

- name: Install
  become: true
  ansible.builtin.apt:
    pkg:
      - teams
